<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>closures</title>
		<script type="text/javascript">
			function createFunctions(){
				var result=new Array();
				
				for(var i=0;i<5;i++){
					result[i]=function(){
						//闭包只会访问父级活动对象，闭包不会记录i的值，只会指向i的链接，因此只能返回i的当前值
						return i;
					};
				}
				
				result.forEach(function(item){
					console.log(item());
				});
			}
			
			createFunctions();
			
			function createFunctions1(){
				var result=new Array();
				
				for(var i=0;i<5;i++){
					result[i]=function(num){
						//立即执行函数，每次把i作为参数传递给返回值，因为立即执行函数即为一个闭包，所以内存不会删除参数
						return function(){
							return num;
						};
					}(i);
				}
				
				result.forEach(function(item){
					console.log(item());
				});
			}
			
			createFunctions1();
			
			function createFunctions2(){
				var result=new Array();
				
				//立即执行函数，每次把i作为参数传递给返回值，因为立即执行函数即为一个闭包，所以内存不会删除参数
				var makeClosure=function(x){
					var makeInClosure=function(){
						return x;
					}
					return makeInClosure;
				}
				
				for(var i=0;i<5;i++){
					result[i]=makeClosure(i);
				}
				
				result.forEach(function(item){
					console.log(item());
				});
			}
			
			createFunctions2();
			
			function createFunctions4(){
				var result=new Array();
				
				for(var i=0;i<5;i++){
					result[i]=function(i){
						//立即执行，传递i，形成闭包
						return i;
					}(i);
				}
				
				result.forEach(function(item){
					console.log(item);
				});
			}
			
			createFunctions4();
		</script>
	</head>
	<body>
	
	</body>
</html>