<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>drag.html</title>
	
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="this is my page">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    
    <!--<link rel="stylesheet" type="text/css" href="./styles.css">-->
	<style type="text/css">
		#drag{
			width:100px;
			height:100px;
			position: absolute;
			background: red;
			left:0px;
			top:0px;
		}
	</style>
	
	<script>
		//设置cookies
		function setCookie(name,value,iDay){
			var nDate=new Date();
			nDate.setDate(nDate.getDate()+iDay);
			document.cookie=name+"="+value+";expires="+nDate;	//设置过期时间
		}
		
		//获取cookies
		function getCookie(name){
			var eachCookie=document.cookie.split("; ");
			
			for(var i=0,j=eachCookie.length;i<j;i++){
				var map=eachCookie[i].split("=");
				var eachName=map[0];
				var eachValue=map[1];
				if(eachName==name){		//名称
					return eachValue;	//值			
				}
			}
			return "";
		}
		
		//移除cookies
		function removeCookie(name){
			setCookie(name,"",-1);
		}
	
		window.onload=function(){
			var drag=document.getElementById("drag");
			drag.style.left=getCookie("left")?getCookie("left"):0+"px";
			drag.style.top=getCookie("top")?getCookie("top"):0+"px";
			
			drag.onmousedown=function(ev){
				var e=ev||event;
			
				var disX=e.clientX-drag.offsetLeft;
				var disY=e.clientY-drag.offsetTop;
				
				console.log(disX);
				console.log(disY);
				
				//如果换成drag,则移出时不移动
				document.onmousemove=function(ev){
					var e=ev||event;
					
					var l=e.clientX-disX;
					var t=e.clientY-disY;
					
					if(l<0){
						l=0;
					}else if(l>document.documentElement.clientWidth-drag.offsetWidth){
						l=document.documentElement.clientWidth-drag.offsetWidth;
					}
					
					if(t<0){
						t=0;
					}else if(t>document.documentElement.clientHeight-drag.offsetHeight){
						t=document.documentElement.clientHeight-drag.offsetHeight;
					}
					
					drag.style.left=l+"px";
					drag.style.top=t+"px";
					
					setCookie("left",l,30);
					setCookie("top",t,30);
				}
				
				document.onmouseup=function(){
					document.onmousemove=null;
					document.onmouseup=null;
				}
				
				return false;	//阻止默认行为，解决火狐二次拖拽bug
			}
		}
	</script>
  </head>
  
  <body style="height: 2000px;">
   	<div id="drag"></div>
  </body>
</html>
